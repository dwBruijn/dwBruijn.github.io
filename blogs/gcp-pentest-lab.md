---
layout: blog
type: blog
title: "Solving GCP Pentest Lab"
date: 2025-11-05
published: true
labels:
  - Cloud Security
  - GCP
  - CTF
---

![Banner](../img/gcp-pentest-lab/banner.avif)

> Description:
> [GCP Pentest Lab](https://github.com/lacioffi/GCP-pentest-lab) is a vulnerable cloud environemnt designed to learn and exploit clouod misconfigurations and vulnerabilities. We will be jumping around the environemnt using different security flaws to uncover embedded flags left for us.

## Setup

All we have to do is clone the [GCP Pentest Lab Github repo](https://github.com/lacioffi/GCP-pentest-lab).
`git clone https://github.com/lacioffi/GCP-pentest-lab.git`

Authenticate to our GCP account via the terminal and select our project where we will be deoploying the vulnerable environment.
`gcloud auth login`

And finally run the Terraform manifests to deploy the environment and enter your GCP project ID.
`terraform init && terraform apply`

When the deployment is done, terraform will return the external IP of a compute engine VM, we can start from there.
![terraform apply output](../img/gcp-pentest-lab/terraform_apply.png)

## Flag 1

> Flag 1 is in an open bucket

Let's start by visiting the public IP address usign our browser
![website](../img/gcp-pentest-lab/website.jpeg)

Looking at the network tab, we notice that images are being fetched from Google Cloud Storage buckets. The first bucket we see is called **gcp-pentest-lab-477312-prod-bucket** (gcp-pentest-lab-477312 is our project ID), so let's check if this bucket is misconfigured and allows us to list its content:

`https://storage.googleapis.com/storage/v1/b/gcp-pentest-lab-477312-prod-bucket/o`

And we can see that we don't have **.list** permission on this resource. The objects in the buckets are public, but we can't list their names.

![flag1 list objects in prod bucket](../img/gcp-pentest-lab/flag1-1.png)

Let's keep loooking for public buckets because that's wehre the flag is. We see another public bucket being accessed: **gcp-pentest-lab-477312-dev-bucket**

`https://storage.googleapis.com/storage/v1/b/gcp-pentest-lab-477312-dev-bucket/o`

And as we can see, we have the **.list** permission on this public bucket.

![flag1 list objects in dev bucket](../img/gcp-pentest-lab/flag1-2.png)

Looking through the files in that bucket we can find a file called **flag1.txt**. 

![flag1 file in bucket](../img/gcp-pentest-lab/flag1-3.png)

We download that file using the **mediaLink**, and that's our first flag!

![flag1](../img/gcp-pentest-lab/flag1-4.png)

